<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Registration</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.js"></script>
</head>
<body>

<div class="container p-4">
    <div class="row">
        <div class="col-sm-8">
            <form id="reg_form">
                <div class="form-group">
                    <label for="first_name">First Name</label>
                    <input name="first_name" type="text" class="form-control" id="first_name" placeholder="Enter First Name">
                </div>
                <div class="form-group">
                    <label for="last_name">Last Name</label>
                    <input name="last_name" type="text" class="form-control" id="last_name" placeholder="Enter Last Name">
                </div>
                <div class="form-group">
                    <label for="email">Email address</label>
                    <input name="email" type="email" class="form-control" id="email" placeholder="Enter Email">
                </div>
                <div class="form-group">
                    <label for="phone">Phone</label>
                    <input name="phone" type="text" class="form-control" id="phone" placeholder="Enter Phone">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input name="password" type="password" class="form-control" id="password" placeholder="Enter Password">
                </div>
                <div class="form-group">
                    <label for="password_confirmation">Password Confirmation</label>
                    <input name="password_confirmation" type="password" class="form-control" id="password_confirmation" placeholder="Confirm Password">
                </div>
                <div class="form-group">
                    <label for="region">Select region</label>
                    <select name="region_id" class="form-control" id="region">
                    </select>
                </div>
                <div class="form-group">
                    <label for="address">Address</label>
                    <textarea name="address" class="form-control" id="address" placeholder="Enter Address"></textarea>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="gender" id="male" value="MALE">
                    <label class="form-check-label" for="male">
                        Male
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="gender" id="female" value="FEMALE">
                    <label class="form-check-label" for="female">
                        Female
                    </label>
                </div>

                <br>
                <button type="button" class="btn btn-primary" onclick="register()">Register</button>
            </form>
        </div>
        <div id="text" class="col-sm-4"></div>
    </div>
</div>

<script>

    $( document ).ready(function() {
        $.get('/api/regions', function (data) {
            for(let i=0;i<data.length;i++) {
                $('#region').append(
                    `
                        <option value="${data[i].id}">${data[i].name}</option>
                    `
                );
            }

        });
    });

    function register() {
        let form_data = new FormData(document.getElementById('reg_form'))
        $.ajax({
            url: 'http://localhost:8000/api/users',
            data: form_data,
            processData: false,
            contentType: false,
            type: 'POST',
            success: function(data){
                $('#text').html('<p class="text-success bg-light">User was successfully created</p>')
                document.getElementById('reg_form').reset()
            },
            error: function (xhr,textStatus,errorThrown) {
                let errors = xhr.responseJSON.errors;
                let html = '';
                for (let key in errors) {
                    html += `<p class="text-danger bg-light">${errors[key][0]}</p>`
                }
                $('#text').html(html);
            }
        });
    }
</script>

</body>
</html>
